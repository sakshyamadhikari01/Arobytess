<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Plant Disease Detection - Gaun Roots</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/ai-detection.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amarna:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Mobile slide menu -->
    <div class="slider-menu" id="sliderMenu">
        <div class="slider-header">
            <span class="slider-title">Menu</span>
            <button class="slider-close" id="sliderClose">X</button>
        </div>
        <ul class="slider-nav">
            <li><a href="home.html">Home</a></li>
            <li><a href="ai-detection.html">AI Detection</a></li>
            <li><a href="fertilizers.html">Find Fertilizers</a></li>
            <li><a href="blogs.html">Agro Blogs</a></li>
            <li><a href="community.html">Community</a></li>
            <li><a href="profile.html">Profile</a></li>
            <li><a href="login.html">Login</a></li>
        </ul>
    </div>
    <div class="slider-overlay" id="sliderOverlay"></div>
    
    <!-- Menu toggle button -->
    <button class="menu-toggle" id="menuToggle">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
    </button>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="home.html" class="logo">
                <img src="/static/images/groot.png" alt="Logo" class="logo-img">
                Gaun Roots
            </a>
            <ul class="nav-menu">
                <li><a href="home.html" class="nav-link">Home</a></li>
                <li><a href="ai-detection.html" class="nav-link active">AI Detection</a></li>
                <li><a href="fertilizers.html" class="nav-link">Find Fertilizers</a></li>
                <li><a href="blogs.html" class="nav-link">Agro Blogs</a></li>
                <li><a href="community.html" class="nav-link">Community</a></li>
                <li><a href="profile.html" class="nav-link">Profile</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main detection interface -->
    <section class="detection-page">
        <div class="detection-header">
            <h1>Plant Disease Detection</h1>
            <p>Snap a photo of your plant and we'll try to figure out what's wrong</p>
            
            <!-- Token Balance Display -->
            <div class="token-info">
                <div class="token-balance">
                    <span class="token-icon">ðŸª™</span>
                    <span>Tokens: <strong id="tokenBalance">0</strong></span>
                </div>
                <button class="btn btn-outline btn-sm" onclick="showBuyTokensModal()">Buy Tokens</button>
                <p class="token-hint">5 free tokens every month â€¢ Rs 49.99 per extra token</p>
            </div>
        </div>

        <div class="detection-content">
            <div class="detection-card">
                <!-- Input method tabs -->
                <div class="input-tabs">
                    <button class="tab-btn active" data-tab="upload">Upload Image</button>
                    <button class="tab-btn" data-tab="camera">Use Camera</button>
                </div>

                <!-- Upload tab content -->
                <div class="tab-content active" id="upload-tab">
                    <div class="upload-area" id="uploadArea">
                        <p>Drag & drop your plant image here</p>
                        <span>or</span>
                        <label class="upload-btn">
                            Browse Files
                            <input type="file" id="fileInput" accept="image/*" hidden>
                        </label>
                    </div>
                </div>

                <!-- Camera tab content -->
                <div class="tab-content" id="camera-tab">
                    <div class="camera-container">
                        <video id="cameraFeed" autoplay playsinline></video>
                        <canvas id="cameraCanvas" style="display:none;"></canvas>
                        <div class="camera-controls">
                            <button class="btn btn-primary" id="startCamera">Start Camera</button>
                            <button class="btn btn-primary" id="captureBtn" disabled>Capture</button>
                            <button class="btn btn-outline" id="switchCamera">Switch</button>
                        </div>
                    </div>
                </div>

                <!-- Image preview -->
                <div class="preview-section" id="previewSection" style="display:none;">
                    <h3>Preview</h3>
                    <img id="previewImage" alt="Preview">
                    <button class="btn btn-primary" id="analyzeBtn">Analyze Plant</button>
                </div>
            </div>

            <!-- Results display -->
            <div class="result-card" id="resultCard" style="display:none;">
                <h2>Analysis Result</h2>
                <div class="result-content">
                    <div class="result-status" id="resultStatus"></div>
                    <div class="result-details" id="resultDetails"></div>
                </div>
            </div>
        </div>

        <!-- Loading overlay -->
        <div class="loading-overlay" id="loadingOverlay" style="display:none;">
            <div class="spinner"></div>
            <p>Analyzing your plant...</p>
        </div>
    </section>

    <!-- Buy Tokens Modal -->
    <div class="modal-overlay" id="buyTokensModal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Buy Scan Tokens</h2>
                <button class="modal-close" onclick="hideBuyTokensModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <p>You've run out of tokens! Purchase more to continue scanning your crops.</p>
                <p class="price-info">Price: <strong>Rs 49.99</strong> per token</p>
                
                <div class="token-packages">
                    <div class="token-package" onclick="purchaseTokens(1)">
                        <span class="package-tokens">1 Token</span>
                        <span class="package-price">Rs 49.99</span>
                    </div>
                    <div class="token-package popular" onclick="purchaseTokens(5)">
                        <span class="package-badge">Popular</span>
                        <span class="package-tokens">5 Tokens</span>
                        <span class="package-price">Rs 249.95</span>
                    </div>
                    <div class="token-package" onclick="purchaseTokens(10)">
                        <span class="package-tokens">10 Tokens</span>
                        <span class="package-price">Rs 499.90</span>
                    </div>
                </div>
                
                <p class="token-note">   You get 5 free tokens every month!</p>
            </div>
        </div>
    </div>

    <script src="/static/js/ai-detection.js"></script>
    <script>
    // Mobile menu handlers
    var menuToggle = document.getElementById('menuToggle');
    var sliderMenu = document.getElementById('sliderMenu');
    var sliderClose = document.getElementById('sliderClose');
    var sliderOverlay = document.getElementById('sliderOverlay');

    function openMobileMenu() {
        sliderMenu.classList.add('active');
        sliderOverlay.classList.add('active');
    }

    function closeMobileMenu() {
        sliderMenu.classList.remove('active');
        sliderOverlay.classList.remove('active');
    }

    menuToggle.addEventListener('click', openMobileMenu);
    sliderClose.addEventListener('click', closeMobileMenu);
    sliderOverlay.addEventListener('click', closeMobileMenu);

    // Close menu when link is clicked
    var sliderLinks = document.querySelectorAll('.slider-nav a');
    sliderLinks.forEach(function(link) {
        link.addEventListener('click', closeMobileMenu);
    });
    </script>
</body>
</html>
